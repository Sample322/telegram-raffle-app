{"ast":null,"code":"import React,{useEffect,useState}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import WebApp from'@twa-dev/sdk';import{Toaster}from'react-hot-toast';// Pages\nimport HomePage from'./pages/HomePage';import RafflePage from'./pages/RafflePage';import LiveRafflePage from'./pages/LiveRafflePage';import RaffleHistoryPage from'./pages/RaffleHistoryPage';import AdminPanel from'./pages/AdminPanel';// Context\nimport{AuthProvider}from'./contexts/AuthContext';// Utils\nimport api from'./services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[isLoading,setIsLoading]=useState(true);const[isAdmin,setIsAdmin]=useState(false);useEffect(()=>{// Initialize Telegram WebApp\nWebApp.ready();WebApp.expand();// Set up API authorization\nif(WebApp.initData){api.defaults.headers.common['Authorization']=`Bearer ${WebApp.initData}`;}// Check if user is admin\ncheckAdminStatus();setIsLoading(false);},[]);const checkAdminStatus=async()=>{try{// Проверяем админа только если есть initData\nif(!WebApp.initData||WebApp.initData===''){setIsAdmin(false);return;}await api.get('/admin/statistics');setIsAdmin(true);}catch(error){var _error$response,_error$response2;// Не логируем 403/401 ошибки - это нормально для не-админов\nif(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)!==403&&((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)!==401){console.error('Admin check error:',error);}setIsAdmin(false);}};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-screen bg-gray-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"})});}return/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-center\"}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/raffle/:id\",element:/*#__PURE__*/_jsx(RafflePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/raffle/:id/live\",element:/*#__PURE__*/_jsx(LiveRafflePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/raffle/:id/history\",element:/*#__PURE__*/_jsx(RaffleHistoryPage,{})}),isAdmin&&/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminPanel,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})]})})});}export default App;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}